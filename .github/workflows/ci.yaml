name: CI

on:
  push:
    branches: [ main ]

env:
  REGISTRY: ghcr.io

jobs:
  AAA:
    outputs:
      fixed: "it is fixed"
      version: ${{ steps.version.outputs.version }}
      compo: ${{ steps.version.outputs.action_fruit }}
    runs-on: ubuntu-latest
    steps:

      - name: Calculate version
        run: |
          IMAGE_VERSION=$(date +'%Y-%m-%d-%H%M')
          echo "Version will be $IMAGE_VERSION"
          echo "$IMAGE_VERSION" >> $GITHUB_ENV
          echo "$IMAGE_VERSION" > eeh-version
          echo "Fininshed Verison stuff"

       - name: 'Upload version artifact'
          uses: actions/upload-artifact@v2
          with:
            name: version
            path: eeh-version
            retention-days: 5
  BBB:
    needs: AAA
    runs-on: ubuntu-latest
    steps:
      
      # - name: Hello B1
      #   run: echo "Hello B1 ${{ jobs.AAA.steps.version.outputs.version }}"
      
      - name: Get version
        uses: actions/download-artifact@v2
        with:
          name: version

      - name: Print version step outputs version
        run: cat eeh-version

